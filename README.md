# Хакатон Dodo

Добро пожаловать в репозиторий, созданный для демонстрации моего решения в первом хакатоне, организованном командой Data Secrets! В этом хакатоне участникам предлагалось решить задачу прогнозирования эффективности промо-рассылок для бренда Dodo Pizza.

## Описание задачи

Dodo Brands – высокотехнологическая компания в сфере общественного питания, которой принадлежит несколько брендов, включая известную всем Dodo Pizza. Сеть насчитывает 1085 точек в 21 стране, и еще 5 откроются в апреле. Одна из задач компании – оценка эффективности промо-рассылок, которые отправляются два раза в неделю всем пользователям.

**Цель задачи**: Создать максимально персонализированное промо-предложение для каждого клиента. Например, скидка 10% при заказе от 1000 рублей (евро, долларов) или маленькая пицца в подарок/со скидкой. Ваша цель – предсказать, воспользуется ли человек промо-кодом или проигнорирует его. Чем точнее предсказание, тем более персонализированные предложения сможет делать компания.

## Данные

В архиве `data.zip` содержатся следующие файлы:

### orders.csv

- **OrderUUId**: уникальный ID заказа
- **addressId**: адрес доставки
- **deliverySectorId**: сектор доставки
- **ClientUUId**: уникальный ID клиента
- **Date**: день заказа
- **SaleDate**: время заказа
- **UnitUUId**: уникальный ID пиццерии
- **NewClient**: 1, если это первый заказ клиента, 0 иначе
- **ClientOrderNumber**: номер заказа клиента
- **ProductUUId**: уникальный ID продукта
- **CategoryId**: ID категории товара
- **ProductTotalPrice**: цена продукта с учетом скидок
- **MenuPrice**: цена в меню
- **OrderState**: статус заказа
- **OrderPaymentType**: тип платежа
- **OrderTotalPrice**: общая сумма заказа
- **OrderType**: тип заказа
- **apply_promo**: 1, если применялся промо-код, 0 иначе

### mobile_events.csv

- **ClientUUId**: уникальный ID клиента
- **VisitToken**: токен сессии
- **EventName**: название события
- **Platform**: платформа
- **Timestamp**: время события

### clients_promo_october.csv

- **ClientUUId**: уникальный ID клиента
- **Id**: механика
- **LocalBeginDate**: старт кампании
- **LocalEndDate**: конец кампании
- **OrderType**: тип заказа
- **OrderPrice**: порог срабатывания
- **Discount**: вознаграждение

### train_target.csv

- **ClientUUId**: уникальный ID клиента
- **Id**: механика
- **OrderType**: тип заказа
- **LocalBeginDate**: старт кампании
- **LocalEndDate**: конец кампании
- **OrderPrice**: порог срабатывания
- **Discount**: вознаграждение
- **apply_promo**: факт использования промо (таргет)

### test.csv

- **ClientUUId**
- **Id**
- **OrderType**
- **LocalBeginDate**
- **LocalEndDate**
- **OrderPrice**
- **Discount**

**OrderType** может принимать значения 1, 2 или 3, где 2 и 3 – ресторан, 1 – доставка.

## Отправка результатов и оценка решения

Ваш сабмит должен быть представлен в виде файла, содержащего столбец `apply_promo` — предсказанные вероятности использования промо-кода. Убедитесь, что порядок строк в сабмите соответствует порядку строк в `test.csv`. В файле `submit.csv` представлен пример формата, в котором должен быть отправлен ответ.

Метрикой задачи является ROC-AUC. Победители определяются по максимальному значению метрики.

## Описание моего кода

В данном репозитории вы найдете файл `Rec_model.ipynb`, содержащий весь процесс разработки модели для предсказания использования промо-кодов. Вот основные шаги, реализованные в коде:

### Загрузка и предобработка данных

1. **Загрузка данных**:
    - Использование библиотеки `pandas` для загрузки и обработки данных из CSV-файлов.
    - Объединение данных из разных источников для создания единого набора данных для анализа.

2. **Предобработка данных**:
    - Преобразование временных меток в формат `datetime`.
    - Создание новых признаков, таких как количество предыдущих заказов, общее количество потраченных средств и других метрик, которые могут быть полезны для предсказательной модели.
    - Обработка пропущенных значений и кодирование категориальных признаков.

### Разработка модели

3. **Разделение данных**:
    - Разделение данных на тренировочный и тестовый наборы.
    - Использование кросс-валидации для оценки производительности модели.

4. **Выбор модели**:
    - Использование библиотеки `scikit-learn` для создания и обучения различных моделей машинного обучения.
    - Тестирование нескольких моделей, таких как Random Forest, Adaptive Boosting и CatBoosting.

5. **Гиперпараметрическая оптимизация**:
    - Применение метода Grid Search для поиска оптимальных гиперпараметров модели.

6. **Оценка модели**:
    - Использование метрики ROC-AUC для оценки производительности модели.

### Финальное предсказание и сабмит

7. **Предсказание на тестовом наборе**:
    - Применение обученной модели для предсказания вероятностей использования промо-кодов на тестовом наборе данных.

8. **Создание сабмита**:
    - Формирование файла `submit.csv` с предсказанными вероятностями.
    - Убедиться, что порядок строк в сабмите соответствует порядку строк в `test.csv`.

## Итоги

Я занял 41-е место в этом хакатоне. Это был увлекательный опыт, и я многому научился в процессе работы над задачей.
